$(function(){const e=$(".promo");$("#close-propmo").bind("click",function(){e.addClass("is-close"),setTimeout(function(){e.addClass("is-novisible")},2e3)});const t=new class{constructor(){this.price=5,this.lvl=5,this.count=1}plus(){this.count=new Number(this.count+1),this.price=(this.lvl*this.count).toFixed(2),this.recalculate()}minus(){this.count=new Number(this.count-1),this.price=(this.lvl*this.count).toFixed(2),this.recalculate()}takePrice(){return this.price}setLvl(e){this.lvl=e,this.recalculate()}changeCount(e){this.count=new Number(e),this.recalculate()}recalculate(){this.price=(this.lvl*this.count).toFixed(2),s.val(this.count),a.text(this.price)}},n=$(".btn-plus"),c=$(".btn-minus"),s=$(".input-counter"),i=$(".form-lvl"),a=$(".span-price");n.bind("click",function(){t.plus()}),c.bind("click",function(){t.minus()}),s.on("change paste keyup",function(){$.isNumeric(s.val())?t.changeCount(s.val()):""==s.val()||$.isNumeric(s.val())||s.val(1)}),i.change(function(){switch(i.val()){case"Light":t.setLvl(5);break;case"Middle":t.setLvl(8.5);break;case"Hardcore":t.setLvl(10.99)}});const o=$(".btn-popup"),l=$("#popUp"),r=$("#close-popUp"),u=$(".popUp-form");o.bind("click",function(e){p.val(""),l.css("display","block")}),r.bind("click",function(){l.css("display","none")}),$(document).bind("click",function(e){u.is(e.target)||0!==u.has(e.target).length||$(e.target).hasClass("btn-popup")||l.css("display","none")});const p=$("#countries"),h=$(".form-phone"),v=$(".form-email"),d=$(".form-name");p.bind("click",function(e){switch(e.target.value){case"Ukraine":p.removeClass("countries-cuba countries-bel"),p.addClass("countries-ukr"),h.attr("placeholder","+ 38");break;case"Belarus":p.removeClass("countries-cuba countries-ukr"),p.addClass("countries-bel"),h.attr("placeholder","+ 375");break;case"Cuba":p.removeClass("countries-bel countries-ukr"),p.addClass("countries-cuba"),h.attr("placeholder","+ 53")}p.val("")}),d.on("keypress",function(){var e=this;setTimeout(function(){const t=/[^а-яА-ЯїЇєЄіІёЁҐґ\- ’'‘"()]/g.exec(e.value);e.value=e.value.replace(t,"")},0)}),h.keypress(function(e){if((e=e||window.event).charCode&&0!=e.charCode&&(e.charCode<48||e.charCode>57))return!1});const f=$(".form_submit"),m=$(".phone-error-message"),k=$(".name-error-message"),b=$(".email-error-message"),g=$("#popUp2");function C(e){return 0===e.length?"Это поле обязательно для заполнения":e.length<10?"Пожалуйста, введите 10 или более цифр":"ok"}function x(e){if(0===e.length)return"Это поле обязательно для заполнения";return-1===e.search(/^[a-z0-9_.-]+@[a-z0-9-]+\.([a-z]{1,6}\.)?[a-z]{2,6}$/i)?"Поле email не соответствует формату":"ok"}function y(e){return 0===e.length?"Это поле обязательно для заполнения":e.length<3?"Пожалуйста, введите 3 или более символов.":"ok"}f.on("click",function(){if("ok"===C(h.val())&&"ok"===y(d.val())&&"ok"===x(v.val())){const e=JSON.stringify({email:v.val(),name:d.val(),phone:h.val(),lvlProduct:i.val(),price:t.takePrice()});event.preventDefault(),$.ajax({type:"POST",url:"http://localhost:5000/file/add",data:{clientObj:e},success:function(){k.text(""),m.text(""),b.text(""),v.val(""),d.val(""),h.val(""),l.css("display","none"),g.css("display","block")},error:function(e){console.log(e)}})}else b.text("ok"===x(v.val())?"":x(v.val())),k.text("ok"===y(d.val())?"":y(d.val())),m.text("ok"===C(h.val())?"":C(h.val()))}),$(".send-form_btn, #close-popUp2").click(function(){g.css("display","none")})}(jQuery));